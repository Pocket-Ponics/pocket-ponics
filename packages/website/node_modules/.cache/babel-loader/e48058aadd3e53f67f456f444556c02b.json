{"ast":null,"code":"import base64 from 'base-64';\nvar host = '10.171.204.187';\nvar port = '8080';\nvar waitingTime = 15000;\nvar APIUtil = {\n  processTextResults: function processTextResults(res) {\n    return Promise.resolve(res.text());\n  },\n  put: function put(endpoint, token, body) {\n    return APIUtil.timeoutFetch(waitingTime, fetch(endpoint, {\n      method: 'PUT',\n      headers: new Headers({\n        'Authorization': 'Bearer ' + token,\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }),\n      body: APIUtil.urlEncode(body),\n      redirect: 'follow'\n    })).then(function (response) {\n      return response.text();\n    }).then(function (result) {\n      console.log(result);\n      JSON.parse(result);\n    });\n  },\n  urlEncode: function urlEncode(object) {\n    var url = [];\n\n    for (var property in object) {\n      var encodedKey = encodeURIComponent(property);\n      var encodedValue = encodeURIComponent(object[property]);\n      url.push(encodedKey + '=' + encodedValue);\n    }\n\n    return url.join('&');\n  },\n  timeoutFetch: function timeoutFetch(ms, promise) {\n    return new Promise(function (resolve, reject) {\n      var timeoutId = setTimeout(function () {\n        reject(new Error('API timeout'));\n      }, ms);\n      promise.then(function (res) {\n        clearTimeout(timeoutId);\n        resolve(res);\n      }, function (err) {\n        clearTimeout(timeoutId);\n        reject(err);\n      });\n    });\n  },\n  getAuthToken: function getAuthToken(username, password) {\n    return APIUtil.timeoutFetch(10000, fetch(\"http://\".concat(host, \":\").concat(port, \"/auth/get_token_admin\"), {\n      method: 'GET',\n      headers: new Headers({\n        'Authorization': 'Basic ' + base64.encode(\"\".concat(username, \":\").concat(password)),\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }),\n      redirect: 'follow'\n    })).then(function (response) {\n      return response.text();\n    }).then(function (result) {\n      return JSON.parse(result);\n    });\n  },\n  createUser: function createUser(email, password) {\n    var encode = APIUtil.urlEncode({\n      email: email,\n      password: password\n    });\n    return APIUtil.timeoutFetch(10000, fetch(\"http://\".concat(host, \":\").concat(port, \"/auth/create_user\"), {\n      method: 'POST',\n      headers: new Headers({\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }),\n      body: encode,\n      redirect: 'follow'\n    })).then(function (response) {\n      return response.text();\n    }).then(function (result) {\n      console.log(result);\n      return JSON.parse(result);\n    });\n  },\n  get: function get(endpoint, token, body) {\n    return APIUtil.timeoutFetch(10000, fetch(endpoint, {\n      method: 'GET',\n      headers: new Headers({\n        'Authorization': 'Bearer ' + token,\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }),\n      body: APIUtil.urlEncode(body),\n      redirect: 'follow'\n    })).then(function (response) {\n      return response.text();\n    }).then(function (result) {\n      return JSON.parse(result);\n    });\n  },\n  changePassword: function changePassword(token, email, old_password, new_password) {\n    return APIUtil.post(\"http://\".concat(host, \":\").concat(port, \"/auth/change_password\"), token, {\n      email: email,\n      old_password: old_password,\n      new_password: new_password\n    });\n  },\n  createPlantIdeal: function createPlantIdeal(token, ph_level_low, ec_level_low, temp_low, cycle_time, ph_level_high, ec_level_high, temp_high, name, light_time, steps, plant_url, harvest_url, num_plants) {\n    console.log(\"token:\", token);\n    return APIUtil.post(\"http://\".concat(host, \":\").concat(port, \"/adminportal\"), token, {\n      ph_level_low: ph_level_low,\n      ec_level_low: ec_level_low,\n      temp_low: temp_low,\n      cycle_time: cycle_time,\n      ph_level_high: ph_level_high,\n      ec_level_high: ec_level_high,\n      temp_high: temp_high,\n      name: name,\n      light_time: light_time,\n      steps: steps,\n      plant_url: plant_url,\n      harvest_url: harvest_url,\n      num_plants: num_plants\n    });\n  },\n  post: function post(endpoint, token, body) {\n    console.log(\"body:\", body);\n    return APIUtil.timeoutFetch(waitingTime, fetch(endpoint, {\n      method: 'POST',\n      headers: new Headers({\n        'Authorization': 'Bearer ' + token,\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }),\n      body: APIUtil.urlEncode(body),\n      redirect: 'follow'\n    })).then(function (response) {\n      return response.text();\n    }).then(function (result) {\n      console.log(result);\n      JSON.parse(result);\n      window.alert(result);\n      window.location.href = \"http://localhost:3000/AdminHome\";\n    });\n  },\n  getPlants: function getPlants() {\n    return APIUtil.get(\"http://\".concat(host, \":\").concat(port, \"/adminportal\"), '', {});\n  }\n};\nexport default APIUtil;","map":{"version":3,"sources":["/Users/alexcusell/Documents/GitHub/pocket-ponics/packages/website/src/util/api-util.js"],"names":["base64","host","port","waitingTime","APIUtil","processTextResults","res","Promise","resolve","text","put","endpoint","token","body","timeoutFetch","fetch","method","headers","Headers","urlEncode","redirect","then","response","result","console","log","JSON","parse","object","url","property","encodedKey","encodeURIComponent","encodedValue","push","join","ms","promise","reject","timeoutId","setTimeout","Error","clearTimeout","err","getAuthToken","username","password","encode","createUser","email","get","changePassword","old_password","new_password","post","createPlantIdeal","ph_level_low","ec_level_low","temp_low","cycle_time","ph_level_high","ec_level_high","temp_high","name","light_time","steps","plant_url","harvest_url","num_plants","window","alert","location","href","getPlants"],"mappings":"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","sourcesContent":["import base64 from 'base-64'\n\nconst host = '10.171.204.187'\nconst port = '8080'\n\nconst waitingTime = 15000\n\nconst APIUtil = {\n\tprocessTextResults(res) {\n\t\treturn Promise.resolve(res.text())\n\t},\n\tput(endpoint, token, body) {\n\t\treturn APIUtil.timeoutFetch(waitingTime, fetch(endpoint, {\n\t\t\tmethod: 'PUT',\n\t\t\theaders: new Headers({\n\t\t\t\t'Authorization': 'Bearer ' + token,\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t}),\n\t\t\tbody: APIUtil.urlEncode(body),\n\t\t\tredirect: 'follow'\n\t\t}))\n\t\t\t.then(response => response.text())\n\t\t\t.then(result => {console.log(result); JSON.parse(result)})\n\t},\n\turlEncode(object) {\n\t\tvar url = []\n\t\tfor (var property in object) {\n\t\t\tvar encodedKey = encodeURIComponent(property)\n\t\t\tvar encodedValue = encodeURIComponent(object[property])\n\t\t\turl.push(encodedKey + '=' + encodedValue)\n\t\t}\n\t\treturn url.join('&')\n\t},\n\ttimeoutFetch(ms, promise) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst timeoutId = setTimeout(() => {\n\t\t\t\treject(new Error('API timeout'))\n\t\t\t}, ms)\n\t\t\tpromise.then(\n\t\t\t\t(res) => {\n\t\t\t\t\tclearTimeout(timeoutId)\n\t\t\t\t\tresolve(res)\n\t\t\t\t},\n\t\t\t\t(err) => {\n\t\t\t\t\tclearTimeout(timeoutId)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t},\n\tgetAuthToken(username, password) {\n\t\treturn APIUtil.timeoutFetch(10000, fetch(`http://${host}:${port}/auth/get_token_admin`, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: new Headers({\n\t\t\t\t'Authorization': 'Basic ' + base64.encode(`${username}:${password}`),\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t}),\n\t\t\tredirect: 'follow'\n\t\t}))\n\t\t\t.then(response => response.text())\n\t\t\t.then(result => JSON.parse(result))\n\t},\n\tcreateUser(email, password) {\n\t\tconst encode = APIUtil.urlEncode({ email, password })\n\t\treturn APIUtil.timeoutFetch(10000, fetch(`http://${host}:${port}/auth/create_user`, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: new Headers({\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t}),\n\t\t\tbody: encode,\n\t\t\tredirect: 'follow'\n\t\t}))\n\t\t\t.then(response => response.text())\n\t\t\t.then(result => {console.log(result); return JSON.parse(result)})\n\t},\n\tget(endpoint, token, body) {\n\t\treturn APIUtil.timeoutFetch(10000, fetch(endpoint, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: new Headers({\n\t\t\t\t'Authorization': 'Bearer ' + token,\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t}),\n\t\t\tbody: APIUtil.urlEncode(body),\n\t\t\tredirect: 'follow'\n\t\t}))\n\t\t\t.then(response => response.text())\n\t\t\t.then(result => JSON.parse(result))\n\t},\n\tchangePassword(token, email, old_password, new_password) {\n\t\treturn APIUtil.post(`http://${host}:${port}/auth/change_password`, token, {\n\t\t\temail,\n\t\t\told_password,\n\t\t\tnew_password\n\t\t})\n\t},\n\tcreatePlantIdeal(token, ph_level_low, ec_level_low, temp_low, cycle_time, ph_level_high, ec_level_high, temp_high, name, light_time, steps, plant_url, harvest_url, num_plants){\n\t\tconsole.log(\"token:\", token)\n\t\treturn APIUtil.post(`http://${host}:${port}/adminportal`, token,{\n\t\t\tph_level_low,\n\t\t    ec_level_low,\n\t\t    temp_low,\n\t\t    cycle_time, \n\t\t    ph_level_high, \n\t\t    ec_level_high, \n\t\t    temp_high, \n\t\t    name, \n\t\t    light_time, \n\t\t    steps, \n\t\t    plant_url, \n\t\t    harvest_url,\n\t\t    num_plants\n\t\t})\n\t},\n\tpost(endpoint, token, body) {\n\t\tconsole.log(\"body:\", body)\n\t\treturn APIUtil.timeoutFetch(waitingTime, fetch(endpoint, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: new Headers({\n\t\t\t\t'Authorization': 'Bearer ' + token,\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t}),\n\t\t\tbody: APIUtil.urlEncode(body),\n\t\t\tredirect: 'follow'\n\t\t}))\n\t\t\t.then(response => response.text())\n\t\t\t.then(result => {console.log(result); JSON.parse(result); window.alert(result); window.location.href=\"http://localhost:3000/AdminHome\"})\n\n\t},\n\tgetPlants() {\n\t\treturn APIUtil.get(`http://${host}:${port}/adminportal`, '', {})\n\t}\n}\n\nexport default APIUtil"]},"metadata":{},"sourceType":"module"}